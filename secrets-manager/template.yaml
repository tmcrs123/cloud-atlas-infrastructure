AWSTemplateFormatVersion: "2010-09-09"
Parameters:
  Environment:
    Type: String
    Description: Deployment environment (test,production)
    AllowedValues:
      - test
      - production
    Default: test
Resources:
  CloudfrontPrivateKey:
    Type: AWS::SecretsManager::Secret
    Properties:
      Name: !Sub snappin-${Environment}-cloudfront-private-key
      Description: The private key used by cloudfront to sign urls
      SecretString: |
        -----BEGIN PRIVATE KEY-----
        MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDOi8Z/g/ZAc79O
        gBl8NZ1KcOGykiybIWywEdra++rIfhnH8e26tSrSNxqjpX2Z63RgYVLiQjBmZibj
        BNtldcSNgC4L6tLZ0Vg18bcCWa7KeU+0wg+yAhomWxsXTvwZqNbWnpUC0cxLUfJA
        JEFPhQmdA5nvKCK4VAzQ07MJhfVXiM7ntxbc9Ra3VV3RuYkhPhXvs4MP1BRGbYU3
        kisVRT22SOwAwC2GB4oVCwNmQA9IePCUg6QvG55sdVHsJ/TJ3W1m5N8POnQear0d
        kHMdsFQ1dcY+RdKeIjLwivfoPSsy+s8Nei5VThcZAqXKqhzNuWbg7NSkzhk75Ydn
        Md5LVyZdAgMBAAECggEABjPMUif0TRsss37FRSWXA5VAMcyR6lamnOLsX4cRFdQz
        kf2B1gl6r7VX53Igw25+oCZMBt9V9L08jbSnofRXYqhmuZTjoAbZT0Vi6X8n8IyU
        CCmLrxzBDEXQGnMUvvCDAw7gCqWiLODZFXQBQhIMp9pj1PqvkDl16Q9yYObU5zv2
        pA7dWw6wNDyXA+Y++3mrO2LpXbBxvRc7GPYbVVB/eeRI2U2crTVNFU5S+Ky7J68s
        k33WQ+1vnPS7U3HezDSLDPPuIJmaYT6XBxgRk/FxSIqvp/yEqVIJiv9/JDXiKONg
        OI3+fc2zOBQ5tBf0UFdaxGIvu0Tl+o8Q/gXJkMHWAQKBgQD1A1NRDwM4WXif/USG
        C1PqWZB9McVYqKrWAEF+QsJ7/nM6D8xOIKGtcgnCTY7nR77XrRVKf3BymbjNkJPv
        rgSbRouau3PIVgkDJ1HmtkO9uzjGPBKnKWmQOGVxqQQNgtTX16gb+ZWmwkFon1GR
        jh7TKGTlZELL/4Hy6z8OT8aa1QKBgQDXztxN4TDsjiY0ZoEf//nyu9d6V5QCs3zv
        th4qS8S8NDk9s8EkwLfGcaaufrbm6H0vc5reqPF5j5HQTV+yG2mRaVOpuMEUhJ0C
        EWs1ghaTGPEBvgO8YzMPVSZJaDILHby3OCJTbN3E66PebbtaTKezfqaeaZFiHpgw
        9d0DKfORaQKBgFokzxKTo2un/2ldlUh8AnPGYBKvrRvhcnkpvu7lQQi9pUdHaLOV
        7eYSfuSuBFWzX9OaKqsuGAER7Zw0BTm5nJhEbDiRnxemD8rJPKjVhjbYGxtUHsjB
        w8T7+tbGiGcwK37+KSuhuB2Set4zP5992nl18ykyqiDD8NufEaQCVd/BAoGAbfrv
        DQWBgFylHblLfvpd8BVIqAGv3XyJZESEtPtuJJfcwBQ2jztjrM9Iqc7L+XtsKN2a
        hHTGszO2lNiJt2P+9esehvUv+PvoZCBqaZeFV6uzTzb+AmjvoZW8cFaYgk/CWAFU
        hP2LO4r3NSjo/QjpwjD+Subz/3QmDXWPD8i2Z1kCgYEA7ydR4QPPwESstShf36OZ
        gst9AgjpBqygpAunZ+KD1+155o5eMd6g/Sz6ohrsE8ZBDWAPRLn2gdcobGHeMnUS
        nhEj+2exc08YcJg2IYNP57fakgcduS17YX5EH4gHYQjKwcVNbE3Ra7WD7GMwWOCz
        AFJSCsB2pG01nFdw6Ie2AMc=
        -----END PRIVATE KEY-----

Outputs:
  CloudfrontPrivateKeyArn:
    Description: "The ARN of the secret that contains the private key to sign cloudfront URLs"
    Value: !GetAtt CloudfrontPrivateKey.Id
    Export:
      Name: !Sub "snappin-${Environment}-cloudfront-private-key-arn"
  CloudfrontPrivateKeyName:
    Description: "The name of the secret that contains the private key to sign cloudfront URLs"
    Value: !Sub snappin-${Environment}-cloudfront-private-key
    Export:
      Name: !Sub "snappin-${Environment}-cloudfront-private-key-name"
